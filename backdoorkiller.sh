#!/bin/bash

# Default extensions for scanning
extensions=(
    "php" "phtml" "phar" "asp" "aspx" "jsp" "jspx" "cgi" "pl" "py" "rb" "sh" "shtml" 
    "txt" "html" "htm" "jpg" "gif" "png" "bmp" "ico" "php.txt" "php.jpg" "php.gif" 
    "php.png" "php.ico" "php%00.jpg" "php%00.gif" "p úp" "PhP" "pHp" "PHp" "php. " 
    "php. ." "php::$DATA" "php;1" "../php" "../phar" "phtml.txt" "phtml.jpg" "phtml.gif" 
    "phtml.png" "phtml.ico" "phar.txt" "phar.jpg" "phar.gif" "phar.png" "phar.ico" "php5" 
    "php7" "php8" "php3" "php4" "pht" "phtm" "pgif"
)

# Default keywords for scanning
keywords=(
        "passthru", "pcntl_exec", "backconnect", "base64_decode", "base64_encode", "shell_exec", "SISTEMIT_COM_ENC", "php_uname", "rooting", "mailer", "str_rot13", 
        "SCC465", '<?php ${"\x47', "exec", "proc_open", "backdoor", "webshell", "shell", "eval", "hacker", "hacked", "pwnkit", "cmd", "disable_functions", 
        "/etc/passwd", "/etc/hosts", "uname", "file_get_contents", "Uname", "system", "popen", "move_uploaded_file", "curl_exec", "file_put_contents", "fwrite", 
        "getcwd", "chmod", "@copy", "alfa", "assert", "preg_replace", "phpinfo", "gzinflate", "gzuncompress", "readfile", "include", "require", "include_once", 
        "require_once", "file", "scandir", "opendir", "readdir", "ftp_connect", "ftp_login", "ftp_put", "ftp_get", "fgets", "fread", "fopen", "fpassthru", "rmdir", 
        "unlink", "touch", "http_get", "http_post", "stream_socket_client", "fsockopen", "socket_create", "socket_connect", "socket_write", "socket_read", 
        "highlight_file", "show_source", "dl", "posix_getpwuid", "posix_getgrgid", "proc_get_status", "proc_close", "posix_kill", "proc_terminate", "tmpfile", 
        "SCRIPT_FILENAME", "pfsockopen", "file_exists", "is_writable", "is_readable", "is_executable", "lstat", "symlink", "readlink", "link", "ftp_nb_fput", 
        "ftp_nb_get", "ftp_fput", "ftp_fget", "ftp_size", "ftp_chmod", "ftp_mkdir", "ftp_rmdir", "ftp_rename", "ftp_delete", "ftp_site", "ftp_raw", "ftp_rawlist", 
        "ftp_systype", "ftp_pwd", "ftp_cdup", "ftp_nlist", "ftp_mdtm", "ftp_pasv", "ftp_chdir", "ftp_alloc", "ftp_close", "ftp_ssl_connect", "error_log", "ini_set", 
        "set_time_limit", "ignore_user_abort", "socket_create_pair", "socket_select", "socket_shutdown", "socket_bind", "socket_listen", "socket_accept", 
        "socket_getpeername", "socket_getsockname", "socket_send", "socket_recv", "curl_init", "curl_setopt", "curl_close", "curl_getinfo", "curl_error", "curl_errno", 
        "apache_request_headers", "getallheaders", "headers_list", "header_remove", "header_register_callback", "header", "get_headers", "get_meta_tags", 
        "zend_version", "phpcredits", "apache_get_version", "apache_get_modules", "apache_get_config", "apache_getenv", "apache_note", "apache_setenv", 
        "apache_child_terminate", "apache_lookup_uri", "apache_response_headers", "apc_cache_info", "apc_clear_cache", "apc_define_constants", "apc_load_constants", 
        "apc_compile_file", "apc_delete_file", "apc_fetch", "apc_store", "apc_add", "apc_delete", "apc_exists", "apc_inc", "apc_dec", "apc_cas", "apc_bin_dump", 
        "apc_bin_load", "apc_sma_info", "opcache_get_status", "opcache_get_configuration", "opcache_compile_file", "opcache_invalidate", "opcache_reset", 
        "opcache_status", "create_function", "call_user_func", "call_user_func_array", "forward_static_call", "forward_static_call_array", "call_user_method", 
        "call_user_method_array", "array_map", "array_walk", "array_filter", "array_reduce", "array_walk_recursive", "goto", "uasort", "uksort", "usort", 
        "register_shutdown_function", "register_tick_function", "fputs", "fclose", "glob", "rename", "copy", "is_file", "is_dir", "is_link", "chown", "chgrp", 
        "stat", "disk_total_space", "disk_free_space", "diskfreespace", "disk_used_space", "mkdir", "utime", "fnmatch", "realpath_cache_get", "realpath_cache_size", 
        "closedir", "dir", "chroot", "chdir", "is_uploaded_file",
        '\x70\x61\x73\x73\x74\x68\x72\x75', '\x70\x63\x6e\x74\x6c\x5f\x65\x78\x65\x63', '\x62\x61\x63\x6b\x63\x6f\x6e\x6e\x65\x63\x74', '\x62\x61\x73\x65\x36\x34\x5f\x64\x65\x63\x6f\x64\x65', '\x62\x61\x73\x65\x36\x34\x5f\x65\x6e\x63\x6f\x64\x65', 
        '\x73\x68\x65\x6c\x6c\x5f\x65\x78\x65\x63', '\x53\x49\x53\x54\x45\x4d\x49\x54\x5f\x43\x4f\x4d\x5f\x45\x4e\x43', '\x70\x68\x70\x5f\x75\x6e\x61\x6d\x65', '\x72\x6f\x6f\x74\x69\x6e\x67', '\x6d\x61\x69\x6c\x65\x72', '\x73\x74\x72\x5f\x72\x6f\x74\x31\x33', '\x53\x43\x43\x34\x36\x35',
        '\x3c\x3f\x70\x68\x70\x20\x24\x7b\x22\x5c\x78\x34\x37', '\x65\x78\x65\x63', '\x70\x72\x6f\x63\x5f\x6f\x70\x65\x6e', '\x62\x61\x63\x6b\x64\x6f\x6f\x72', '\x77\x65\x62\x73\x68\x65\x6c\x6c', '\x73\x68\x65\x6c\x6c', '\x65\x76\x61\x6c', '\x68\x61\x63\x6b\x65\x72', 
        '\x68\x61\x63\x6b\x65\x64', '\x70\x77\x6e\x6b\x69\x74', '\x63\x6d\x64', '\x64\x69\x73\x61\x62\x6c\x65\x5f\x66\x75\x6e\x63\x74\x69\x6f\x6e\x73', '\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64', '\x2f\x65\x74\x63\x2f\x68\x6f\x73\x74\x73', '\x75\x6e\x61\x6d\x65', 
        '\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f\x63\x6f\x6e\x74\x65\x6e\x74\x73', '\x55\x6e\x61\x6d\x65', '\x73\x79\x73\x74\x65\x6d', '\x70\x6f\x70\x65\x6e', '\x6d\x6f\x76\x65\x5f\x75\x70\x6c\x6f\x61\x64\x65\x64\x5f\x66\x69\x6c\x65', '\x63\x75\x72\x6c\x5f\x65\x78\x65\x63', 
        '\x66\x69\x6c\x65\x5f\x70\x75\x74\x5f\x63\x6f\x6e\x74\x65\x6e\x74\x73', '\x75\x6E\x69\x78\x2E\x31\x31', '\x66\x77\x72\x69\x74\x65', '\x67\x65\x74\x63\x77\x64', '\x63\x68\x6d\x6f\x64', '\x40\x63\x6f\x70\x79', '\x61\x6c\x66\x61', '\x61\x73\x73\x65\x72\x74', 
        '\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61\x63\x65', '\x70\x68\x70\x69\x6e\x66\x6f', '\x67\x7a\x69\x6e\x66\x6c\x61\x74\x65', '\x67\x7a\x75\x6e\x63\x6f\x6d\x70\x72\x65\x73\x73', '\x72\x65\x61\x64\x66\x69\x6c\x65', 
        '\x69\x6e\x63\x6c\x75\x64\x65', '\x72\x65\x71\x75\x69\x72\x65', '\x69\x6e\x63\x6c\x75\x64\x65\x5f\x6f\x6e\x63\x65', '\x72\x65\x71\x75\x69\x72\x65\x5f\x6f\x6e\x63\x65', '\x66\x69\x6c\x65', '\x73\x63\x61\x6e\x64\x69\x72', '\x6f\x70\x65\x6e\x64\x69\x72', 
        '\x72\x65\x61\x64\x64\x69\x72', '\x66\x74\x70\x5f\x63\x6f\x6e\x6e\x65\x63\x74', '\x53\x43\x52\x49\x50\x54\x5f\x46\x49\x4c\x45\x4e\x41\x4d\x45', '\x66\x74\x70\x5f\x6c\x6f\x67\x69\x6e', '\x66\x74\x70\x5f\x70\x75\x74', '\x66\x74\x70\x5f\x67\x65\x74', '\x66\x67\x65\x74\x73', '\x66\x72\x65\x61\x64', '\x66\x77\x72\x69\x74\x65', 
        '\x66\x6f\x70\x65\x6e', '\x66\x70\x61\x73\x73\x74\x68\x72\x75', '\x72\x6d\x64\x69\x72', '\x75\x6e\x6c\x69\x6e\x6b', '\x74\x6f\x75\x63\x68', '\x68\x74\x74\x70\x5f\x67\x65\x74', '\x68\x74\x74\x70\x5f\x70\x6f\x73\x74', '\x73\x74\x72\x65\x61\x6d\x5f\x73\x6f\x63\x6b\x65\x74\x5f\x63\x6c\x69\x65\x6e\x74', 
        '\x66\x73\x6f\x63\x6b\x6f\x70\x65\x6e', '\x73\x6f\x63\x6b\x65\x74\x5f\x63\x72\x65\x61\x74\x65', '\x73\x6f\x63\x6b\x65\x74\x5f\x63\x6f\x6e\x6e\x65\x63\x74', '\x73\x6f\x63\x6b\x65\x74\x5f\x77\x72\x69\x74\x65', '\x73\x6f\x63\x6b\x65\x74\x5f\x72\x65\x61\x64', 
        '\x68\x69\x67\x68\x6c\x69\x67\x68\x74\x5f\x66\x69\x6c\x65', '\x73\x68\x6f\x77\x5f\x73\x6f\x75\x72\x63\x65', '\x64\x6c', '\x70\x6f\x73\x69\x78\x5f\x67\x65\x74\x70\x77\x75\x69\x64', '\x70\x6f\x73\x69\x78\x5f\x67\x65\x74\x67\x72\x67\x69\x64', 
        '\x70\x72\x6f\x63\x5f\x67\x65\x74\x5f\x73\x74\x61\x74\x75\x73', '\x70\x72\x6f\x63\x5f\x63\x6c\x6f\x73\x65', '\x70\x6f\x73\x69\x78\x5f\x6b\x69\x6c\x6c', '\x70\x72\x6f\x63\x5f\x74\x65\x72\x6d\x69\x6e\x61\x74\x65', '\x74\x6d\x70\x66\x69\x6c\x65', 
        '\x70\x66\x73\x6f\x63\x6b\x6f\x70\x65\x6e', '\x69\x73\x5f\x77\x72\x69\x74\x61\x62\x6c\x65', '\x69\x73\x5f\x72\x65\x61\x64\x61\x62\x6c\x65', '\x69\x73\x5f\x65\x78\x65\x63\x75\x74\x61\x62\x6c\x65', '\x6c\x73\x74\x61\x74', 
        '\x73\x79\x6d\x6c\x69\x6e\x6b', '\x72\x65\x61\x64\x6c\x69\x6e\x6b', '\x6c\x69\x6e\x6b', '\x66\x74\x70\x5f\x6e\x62\x5f\x66\x70\x75\x74', '\x66\x74\x70\x5f\x6e\x62\x5f\x67\x65\x74', '\x66\x74\x70\x5f\x66\x70\x75\x74', '\x66\x74\x70\x5f\x66\x67\x65\x74', 
        '\x66\x74\x70\x5f\x73\x69\x7a\x65', '\x66\x74\x70\x5f\x63\x68\x6d\x6f\x64', '\x66\x74\x70\x5f\x6d\x6b\x64\x69\x72', '\x66\x74\x70\x5f\x72\x6d\x64\x69\x72', '\x66\x74\x70\x5f\x72\x65\x6e\x61\x6d\x65', '\x66\x74\x70\x5f\x64\x65\x6c\x65\x74\x65', '\x66\x74\x70\x5f\x73\x69\x74\x65', 
        '\x66\x74\x70\x5f\x72\x61\x77', '\x66\x74\x70\x5f\x72\x61\x77\x6c\x69\x73\x74', '\x66\x74\x70\x5f\x73\x79\x73\x74\x79\x70\x65', '\x66\x74\x70\x5f\x70\x77\x64', '\x66\x74\x70\x5f\x63\x64\x75\x70', '\x66\x74\x70\x5f\x6e\x6c\x69\x73\x74', '\x66\x74\x70\x5f\x6d\x64\x74\x6d', 
        '\x66\x74\x70\x5f\x70\x61\x73\x76', '\x66\x74\x70\x5f\x63\x68\x64\x69\x72', '\x66\x74\x70\x5f\x61\x6c\x6c\x6f\x63', '\x66\x74\x70\x5f\x63\x6c\x6f\x73\x65', '\x66\x74\x70\x5f\x73\x73\x6c\x5f\x63\x6f\x6e\x6e\x65\x63\x74', '\x66\x74\x70\x5f\x63\x6f\x6e\x6e\x65\x63\x74', 
        '\x65\x72\x72\x6f\x72\x5f\x6c\x6f\x67', '\x69\x6e\x69\x5f\x73\x65\x74', '\x73\x65\x74\x5f\x74\x69\x6d\x65\x5f\x6c\x69\x6d\x69\x74', '\x69\x67\x6e\x6f\x72\x65\x5f\x75\x73\x65\x72\x5f\x61\x62\x6f\x72\x74', '\x73\x6f\x63\x6b\x65\x74\x5f\x63\x72\x65\x61\x74\x65\x5f\x70\x61\x69\x72', 
        '\x73\x6f\x63\x6b\x65\x74\x5f\x73\x65\x6c\x65\x63\x74', '\x73\x6f\x63\x6b\x65\x74\x5f\x73\x68\x75\x74\x64\x6f\x77\x6e', '\x73\x6f\x63\x6b\x65\x74\x5f\x62\x69\x6e\x64', '\x73\x6f\x63\x6b\x65\x74\x5f\x6c\x69\x73\x74\x65\x6e', '\x73\x6f\x63\x6b\x65\x74\x5f\x61\x63\x63\x65\x70\x74', 
        '\x73\x6f\x63\x6b\x65\x74\x5f\x67\x65\x74\x70\x65\x65\x72\x6e\x61\x6d\x65', '\x73\x6f\x63\x6b\x65\x74\x5f\x67\x65\x74\x73\x6f\x63\x6b\x6e\x61\x6d\x65', '\x73\x6f\x63\x6b\x65\x74\x5f\x73\x65\x6e\x64', '\x73\x6f\x63\x6b\x65\x74\x5f\x72\x65\x63\x76', '\x73\x6f\x63\x6b\x65\x74\x5f\x72\x65\x61\x64', 
        '\x73\x6f\x63\x6b\x65\x74\x5f\x63\x6c\x6f\x73\x65', '\x63\x75\x72\x6c\x5f\x69\x6e\x69\x74', '\x63\x75\x72\x6c\x5f\x73\x65\x74\x6f\x70\x74', '\x63\x75\x72\x6c\x5f\x65\x78\x65\x63', '\x63\x75\x72\x6c\x5f\x63\x6c\x6f\x73\x65', '\x63\x75\x72\x6c\x5f\x67\x65\x74\x69\x6e\x66\x6f', 
        '\x63\x75\x72\x6c\x5f\x65\x72\x72\x6f\x72', '\x63\x75\x72\x6c\x5f\x65\x72\x72\x6e\x6f', '\x61\x70\x61\x63\x68\x65\x5f\x72\x65\x71\x75\x65\x73\x74\x5f\x68\x65\x61\x64\x65\x72\x73', '\x67\x65\x74\x61\x6c\x6c\x68\x65\x61\x64\x65\x72\x73', '\x68\x65\x61\x64\x65\x72\x73\x5f\x6c\x69\x73\x74', 
        '\x68\x65\x61\x64\x65\x72\x5f\x72\x65\x6d\x6f\x76\x65', '\x68\x65\x61\x64\x65\x72\x5f\x72\x65\x67\x69\x73\x74\x65\x72\x5f\x63\x61\x6c\x6c\x62\x61\x63\x6b', '\x68\x65\x61\x64\x65\x72', '\x67\x65\x74\x5f\x68\x65\x61\x64\x65\x72\x73', '\x67\x65\x74\x5f\x6d\x65\x74\x61\x5f\x74\x61\x67\x73', 
        '\x70\x68\x70\x69\x6e\x66\x6f', '\x7a\x65\x6e\x64\x5f\x76\x65\x72\x73\x69\x6f\x6e', '\x70\x68\x70\x63\x72\x65\x64\x69\x74\x73', '\x61\x70\x61\x63\x68\x65\x5f\x67\x65\x74\x5f\x76\x65\x72\x73\x69\x6f\x6e', '\x61\x70\x61\x63\x68\x65\x5f\x67\x65\x74\x5f\x6d\x6f\x64\x75\x6c\x65\x73', 
        '\x61\x70\x61\x63\x68\x65\x5f\x67\x65\x74\x5f\x63\x6f\x6e\x66\x69\x67', '\x61\x70\x61\x63\x68\x65\x5f\x67\x65\x74\x65\x6e\x76', '\x61\x70\x61\x63\x68\x65\x5f\x6e\x6f\x74\x65', '\x61\x70\x61\x63\x68\x65\x5f\x73\x65\x74\x65\x6e\x76', 
        '\x61\x70\x61\x63\x68\x65\x5f\x63\x68\x69\x6c\x64\x5f\x74\x65\x72\x6d\x69\x6e\x61\x74\x65', '\x61\x70\x61\x63\x68\x65\x5f\x6c\x6f\x6f\x6b\x75\x70\x5f\x75\x72\x69', '\x61\x70\x61\x63\x68\x65\x5f\x72\x65\x71\x75\x65\x73\x74\x5f\x68\x65\x61\x64\x65\x72\x73', 
        '\x61\x70\x61\x63\x68\x65\x5f\x72\x65\x73\x70\x6f\x6e\x73\x65\x5f\x68\x65\x61\x64\x65\x72\x73', '\x61\x70\x63\x5f\x63\x61\x63\x68\x65\x5f\x69\x6e\x66\x6f', '\x61\x70\x63\x5f\x63\x6c\x65\x61\x72\x5f\x63\x61\x63\x68\x65', '\x61\x70\x63\x5f\x64\x65\x66\x69\x6e\x65\x5f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73', 
        '\x61\x70\x63\x5f\x6c\x6f\x61\x64\x5f\x63\x6f\x6e\x73\x74\x61\x6e\x74\x73', '\x61\x70\x63\x5f\x63\x6f\x6d\x70\x69\x6c\x65\x5f\x66\x69\x6c\x65', '\x61\x70\x63\x5f\x64\x65\x6c\x65\x74\x65\x5f\x66\x69\x6c\x65', '\x61\x70\x63\x5f\x66\x65\x74\x63\x68', '\x61\x70\x63\x5f\x73\x74\x6f\x72\x65', 
        '\x61\x70\x63\x5f\x61\x64\x64', '\x61\x70\x63\x5f\x64\x65\x6c\x65\x74\x65', '\x61\x70\x63\x5f\x65\x78\x69\x73\x74\x73', '\x61\x70\x63\x5f\x69\x6e\x63', '\x61\x70\x63\x5f\x64\x65\x63', '\x61\x70\x63\x5f\x63\x61\x73', '\x61\x70\x63\x5f\x62\x69\x6e\x5f\x64\x75\x6d\x70', 
        '\x61\x70\x63\x5f\x62\x69\x6e\x5f\x6c\x6f\x61\x64', '\x61\x70\x63\x5f\x73\x6d\x61\x5f\x69\x6e\x66\x6f', '\x61\x70\x63\x5f\x63\x61\x63\x68\x65\x5f\x69\x6e\x66\x6f', '\x6f\x70\x63\x61\x63\x68\x65\x5f\x67\x65\x74\x5f\x73\x74\x61\x74\x75\x73', 
        '\x6f\x70\x63\x61\x63\x68\x65\x5f\x67\x65\x74\x5f\x63\x6f\x6e\x66\x69\x67\x75\x72\x61\x74\x69\x6f\x6e', '\x6f\x70\x63\x61\x63\x68\x65\x5f\x63\x6f\x6d\x70\x69\x6c\x65\x5f\x66\x69\x6c\x65', '\x6f\x70\x63\x61\x63\x68\x65\x5f\x69\x6e\x76\x61\x6c\x69\x64\x61\x74\x65', '\x6f\x70\x63\x61\x63\x68\x65\x5f\x72\x65\x73\x65\x74', 
        '\x6f\x70\x63\x61\x63\x68\x65\x5f\x73\x74\x61\x74\x75\x73', '\x65\x78\x65\x63', '\x73\x79\x73\x74\x65\x6d', '\x70\x61\x73\x73\x74\x68\x72\x75', 
        '\x63\x72\x65\x61\x74\x65\x5f\x66\x75\x6e\x63\x74\x69\x6f\x6e', '\x63\x61\x6c\x6c\x5f\x75\x73\x65\x72\x5f\x66\x75\x6e\x63', '\x63\x61\x6c\x6c\x5f\x75\x73\x65\x72\x5f\x66\x75\x6e\x63\x5f\x61\x72\x72\x61\x79', '\x66\x6f\x72\x77\x61\x72\x64\x5f\x73\x74\x61\x74\x69\x63\x5f\x63\x61\x6c\x6c', 
        '\x66\x6f\x72\x77\x61\x72\x64\x5f\x73\x74\x61\x74\x69\x63\x5f\x63\x61\x6c\x6c\x5f\x61\x72\x72\x61\x79', '\x63\x61\x6c\x6c\x5f\x75\x73\x65\x72\x5f\x6d\x65\x74\x68\x6f\x64', '\x63\x61\x6c\x6c\x5f\x75\x73\x65\x72\x5f\x6d\x65\x74\x68\x6f\x64\x5f\x61\x72\x72\x61\x79', '\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61\x63\x65', 
        '\x61\x72\x72\x61\x79\x5f\x6d\x61\x70', '\x61\x72\x72\x61\x79\x5f\x77\x61\x6c\x6b', '\x61\x72\x72\x61\x79\x5f\x66\x69\x6c\x74\x65\x72', '\x61\x72\x72\x61\x79\x5f\x72\x65\x64\x75\x63\x65', '\x61\x72\x72\x61\x79\x5f\x77\x61\x6c\x6b\x5f\x72\x65\x63\x75\x72\x73\x69\x76\x65', 
        '\x75\x61\x73\x6f\x72\x74', '\x75\x6b\x73\x6f\x72\x74', '\x75\x73\x6f\x72\x74', '\x72\x65\x67\x69\x73\x74\x65\x72\x5f\x73\x68\x75\x74\x64\x6f\x77\x6e\x5f\x66\x75\x6e\x63\x74\x69\x6f\x6e', '\x72\x65\x67\x69\x73\x74\x65\x72\x5f\x74\x69\x63\x6b\x5f\x66\x75\x6e\x63\x74\x69\x6f\x6e', 
        '\x68\x69\x67\x68\x6c\x69\x67\x68\x74\x5f\x66\x69\x6c\x65', '\x73\x68\x6f\x77\x5f\x73\x6f\x75\x72\x63\x65', '\x66\x70\x75\x74\x73', '\x66\x63\x6c\x6f\x73\x65', '\x63\x68\x6d\x6f\x64', '\x63\x68\x6f\x77\x6e', '\x63\x68\x67\x72\x70', 
        '\x64\x69\x73\x6b\x5f\x74\x6f\x74\x61\x6c\x5f\x73\x70\x61\x63\x65', '\x64\x69\x73\x6b\x5f\x66\x72\x65\x65\x5f\x73\x70\x61\x63\x65', '\x64\x69\x73\x6b\x66\x72\x65\x65\x73\x70\x61\x63\x65', '\x64\x69\x73\x6b\x5f\x75\x73\x65\x64\x5f\x73\x70\x61\x63\x65', 
        '\x72\x65\x61\x6c\x70\x61\x74\x68\x5f\x63\x61\x63\x68\x65\x5f\x67\x65\x74', '\x72\x65\x61\x6c\x70\x61\x74\x68\x5f\x63\x61\x63\x68\x65\x5f\x73\x69\x7a\x65', '\x69\x73\x5f\x75\x70\x6c\x6f\x61\x64\x65\x64\x5f\x66\x69\x6c\x65', '\x6d\x6f\x76\x65\x5f\x75\x70\x6c\x6f\x61\x64\x65\x64\x5f\x66\x69\x6c\x65'
)

# Function to scan files by extension and keyword
scan_files() {
    local dir=$1
    local results=()
    while IFS= read -r -d '' file; do
        if [[ " ${extensions[*]} " == *".${file##*.} "* ]]; then
            content=$(cat "$file")
            for keyword in "${keywords[@]}"; do
                if [[ $content == *"$keyword"* ]]; then
                    results+=("$file contains $keyword")
                    break
                fi
            done
        fi
    done < <(find "$dir" -type f -print0)
    echo "${results[@]}"
}

# Function to remove files
remove_files() {
    local files=("$@")
    for file in "${files[@]}"; do
        if rm "$file"; then
            echo "Deleted: $file"
        else
            echo "Failed to delete: $file"
        fi
    done
}

# Function to change permissions of files
chmod_files() {
    local files=("$@")
    for file in "${files[@]}"; do
        if chmod 0000 "$file"; then
            echo "Changed permissions to 0000: $file"
        else
            echo "Failed to change permissions: $file"
        fi
    done
}

# Function to change file extensions to .html
change_extension_to_html() {
    local files=("$@")
    for file in "${files[@]}"; do
        new_name="${file%.*}.html"
        if mv "$file" "$new_name"; then
            echo "Changed extension to .html: $new_name"
        else
            echo "Failed to change extension: $file"
        fi
    done
}

# Main script
if [ $# -lt 2 ]; then
    echo "Usage: $0 <directory> <action>"
    echo "Actions: scan, remove, chmod, changeExtension"
    exit 1
fi

directory=$1
action=$2

# Perform the scan
echo "Scanning directory: $directory"
results=$(scan_files "$directory")

# Save results to scan.txt
echo "Saving results to scan.txt"
echo "$results" > scan.txt

# Perform the specified action
if [ "$action" != "scan" ]; then
    files_to_modify=()
    while IFS= read -r line; do
        files_to_modify+=("${line%% contains*}")
    done <<< "$results"

    case $action in
        remove)
            remove_files "${files_to_modify[@]}"
            ;;
        chmod)
            chmod_files "${files_to_modify[@]}"
            ;;
        changeExtension)
            change_extension_to_html "${files_to_modify[@]}"
            ;;
        *)
            echo "Invalid action: $action"
            exit 1
            ;;
    esac
fi

echo "Scan completed. Output has been saved to scan.txt."
